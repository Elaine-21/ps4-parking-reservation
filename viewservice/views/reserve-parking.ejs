<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Reserve Parking</title>
  <link rel="stylesheet" href="/static/style.css">
</head>
<body>
  <div class="container">
    <div class="card">
      <header>
        <h2>Reserve a Slot</h2>
        <a href="/dashboard">Cancel</a>
      </header>

      <% if (typeof error !== 'undefined' && error) { %>
        <div class="alert alert-error"><%= error %></div>
      <% } %>

      <form action="/postReserve" method="POST">
        <div class="form-group">
          <label for="slotId">Parking Slot</label>
          <select id="slotId" name="slotId" required style="font-size: 1.1em; padding: 10px;">
            <option value="">-- Choose a Parking Slot --</option>
            <% if (parkingSlots && parkingSlots.length) { %>
              <% parkingSlots.forEach(function(slot) { 
                 // Create a clean label: "A1 - Floor 1 (Car)"
                 const label = (slot.slot_number || slot.number || 'Slot ' + slot.id) + 
                               " â€” Floor " + slot.floor + 
                               " (" + slot.type + ")";
              %>
                <option value="<%= slot.id %>" data-type="<%= slot.type %>" 
                  <%= (String(slot.id) === String(selectedSlotId)) ? 'selected' : '' %>>
                  <%= label %>
                </option>
              <% }); %>
            <% } %>
          </select>
        </div>

        <div style="display: flex; gap: 15px;">
          <div class="form-group" style="flex: 1;">
            <label>First Name</label>
            <input type="text" value="<%= user.firstName %>" readonly style="background: #e9ecef;">
          </div>
          <div class="form-group" style="flex: 1;">
            <label>Last Name</label>
            <input type="text" value="<%= user.lastName %>" readonly style="background: #e9ecef;">
          </div>
        </div>

        <div style="display: flex; gap: 15px;">
          <div class="form-group" style="flex: 1;">
            <label>Vehicle Plate</label>
            <input type="text" name="plateNumber" placeholder="ABC-1234" required>
          </div>
          <div class="form-group" style="flex: 1;">
            <label>Vehicle Type</label>
            <input id="vehicleType" name="vehicleType" type="text" value="<%= initialVehicleType || '' %>" readonly required style="background: #e9ecef;">
          </div>
        </div>

        <div class="form-group">
          <label>Date</label>
          <input type="date" name="date" required>
        </div>

        <div style="display: flex; gap: 15px;">
          <div class="form-group" style="flex: 1;">
            <label>Start Time</label>
            <input type="time" name="startTime" required>
          </div>
          <div class="form-group" style="flex: 1;">
            <label>End Time</label>
            <input type="time" name="endTime" required>
          </div>
        </div>

        <button type="submit" class="btn btn-primary" style="width: 100%; margin-top: 10px;">Confirm Reservation</button>
      </form>
    </div>
  </div>

  <script src="/static/reserve.js"></script>
</body>
</html>