<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title><%= title %></title>
  <link rel="stylesheet" href="/static/style.css" />
</head>
<body>
  <div class="container" style="max-width: 600px;">
    <div class="card">
      <header>
        <h2 style="color: var(--danger);">Report Violation</h2>
        <a href="/dashboard">Cancel</a>
      </header>

      <% if (locals.error) { %> <div class="alert alert-error"><%= error %></div> <% } %>
      <% if (locals.success) { %> <div class="alert alert-success"><%= success %></div> <% } %>

      <form action="/violation/upload" method="POST">
        
        <div class="form-group">
          <label>Location (Slot)</label>
          <select name="location" required style="font-size:1.1em; padding:10px;">
            <option value="">-- Select Slot where Violation Occurred --</option>
            <% if (locals.parkingSlots && parkingSlots.length > 0) { %>
              <% parkingSlots.forEach(function(slot) { 
                 const label = (slot.slot_number || 'Slot ' + slot.id);
                 const val = "Floor " + slot.floor + " - " + label;
              %>
                <option value="<%= val %>">
                  <%= label %> (Floor <%= slot.floor %>) - <%= slot.type %>
                </option>
              <% }); %>
            <% } else { %>
              <option value="Unknown Location">No slots loaded</option>
            <% } %>
          </select>
        </div>

        <div class="form-group">
          <label>Offender (User ID)</label>
          <input type="text" name="patronId" required placeholder="e.g. 2">
        </div>
        
        <div class="form-group">
          <label>Vehicle Plate Number</label>
          <input type="text" name="plateNumber" required placeholder="ABC-123">
        </div>
        
        <div class="form-group">
          <label>Violation Type</label>
          <select name="violationType">
            <option value="idling">Idling Engine</option>
            <option value="speeding">Speeding</option>
            <option value="honking">Excessive Honking</option>
            <option value="wrong_parking">Wrong Parking / Double Parking</option>
            <option value="unauthorized">Unauthorized Access</option>
          </select>
        </div>
        
        <div class="form-group">
          <label>Fine Amount (PHP)</label>
          <input type="number" name="amount" value="500">
        </div>
        
        <button type="submit" class="btn btn-danger" style="width:100%; margin-top:10px;">Submit Report</button>
      </form>
    </div>
  </div>
</body>
</html>